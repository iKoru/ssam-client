(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d6d45"],{"73e8":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-layout",{attrs:{row:"","justify-center":"","align-center":""}},[a("v-card",{attrs:{width:"100%",flat:""}},[a("v-card-title",{attrs:{"primary-title":""}},[a("v-flex",{attrs:{xs12:""}},[a("h3",{staticClass:"headline mb-0"},[e._v("내 계정 정보")]),a("div",{class:{"text-xs-center justify-center align-center":!0,"pa-3":e.$vuetify.breakpoint.smAndUp}},[a("p",[e.profile.picturePath?a(e.$vuetify.breakpoint.xsOnly?"v-bottom-sheet":"v-menu",{tag:"component",attrs:{absolute:"","offset-y":""},model:{value:e.bottomSheet,callback:function(t){e.bottomSheet=t},expression:"bottomSheet"}},[a("v-avatar",{staticClass:"cursor-pointer",attrs:{slot:"activator",size:e.$vuetify.breakpoint.xsOnly?100:200,title:"클릭하여 이미지 변경 또는 삭제"},slot:"activator"},[a("img",{attrs:{src:e.webUrl+e.profile.picturePath,alt:"프로필 이미지"}})]),a("v-list",[a("v-list-tile",{on:{click:e.deleteProfilePath}},[a("v-list-tile-title",[e._v("프로필 사진 삭제")])],1),a("v-list-tile",{on:{click:function(t){e.bottomSheet=!1,e.selectImage()}}},[a("v-list-tile-title",[e._v("프로필 사진 변경")])],1)],1)],1):a("v-avatar",{staticClass:"cursor-pointer",attrs:{size:e.$vuetify.breakpoint.xsOnly?100:200,title:"클릭하여 이미지 등록"},on:{click:e.selectImage}},[a("img",{attrs:{src:i("53c0"),alt:"기본 프로필 이미지"}})])],1),a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-container",{attrs:{fluid:"","grid-list-xs":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm2:"",xs4:"","py-0":""}},[a("v-subheader",{on:{click:function(t){return e.focus("loungeNickName")}}},[e._v("라운지 필명")])],1),a("v-flex",{attrs:{sm4:"",xs8:"","py-0":""}},[a("v-text-field",{ref:"loungeNickName",staticClass:"mt-0 pt-0 dense",attrs:{placeholder:"라운지 필명",rules:e.nickNameRules,"error-messages":e.loungeNickNameErrors,readonly:!e.checkLoungeNickNameUpdatable,hint:e.checkLoungeNickNameUpdatable?"라운지와 프로필 등에서 사용되는 필명입니다.":"마지막 수정 후 1개월 뒤에 다시 바꿀 수 있습니다."},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.submit(t))},blur:function(t){return e.checkNickName("loungeNickName")}},model:{value:e.profile.loungeNickName,callback:function(t){e.$set(e.profile,"loungeNickName",t)},expression:"profile.loungeNickName"}})],1),a("v-flex",{attrs:{sm2:"",xs4:"","py-0":""}},[a("v-subheader",{on:{click:function(t){return e.focus("topicNickName")}}},[e._v("토픽 닉네임")])],1),a("v-flex",{attrs:{sm4:"",xs8:"","py-0":""}},[a("v-text-field",{ref:"topicNickName",staticClass:"mt-0 pt-0 dense",attrs:{placeholder:"토픽 닉네임",rules:e.nickNameRules,"error-messages":e.topicNickNameErrors,readonly:!e.checkTopicNickNameUpdatable,hint:e.checkTopicNickNameUpdatable?"토픽에서 사용되는 닉네임입니다.":"마지막 수정 후 1개월 뒤에 다시 바꿀 수 있습니다."},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.submit(t))},blur:function(t){return e.checkNickName("topicNickName")}},model:{value:e.profile.topicNickName,callback:function(t){e.$set(e.profile,"topicNickName",t)},expression:"profile.topicNickName"}})],1),a("v-flex",{attrs:{sm2:"",xs4:"","py-0":""}},[a("v-subheader",{style:{"padding-bottom":!!e.$vuetify.breakpoint.xsOnly&&"12px"}},[e._v("인증상태")])],1),a("v-flex",{attrs:{sm4:"",xs8:"","py-0":"","text-xs-left":""}},[a("div",{staticClass:"d-inline-flex align-center fill-height",staticStyle:{"padding-bottom":"12px"}},["A"!==e.profile.auth?a("router-link",{staticClass:"primary--text",attrs:{to:"/auth",title:"이메일 인증 페이지로 이동"}},[e._v(e._s(e.userAuthItems[e.profile.auth||"NORMAL"]))]):a("span",[e._v(e._s(e.userAuthItems[e.profile.auth||"NORMAL"]))]),e.profile.emailVerifiedDate&&"A"===e.profile.auth?a("small",{attrs:{title:"인증한 날짜"}},[e._v("("+e._s(e.$moment(e.profile.emailVerifiedDate,"YYYYMMDD").format("Y.M.D"))+")")]):e._e()],1)]),a("v-flex",{attrs:{sm2:"",xs4:"","py-0":""}},[a("v-subheader",{staticClass:"pr-0 text-xs-left",on:{click:function(t){return e.focus("password")}}},[e._v("비밀번호 변경")])],1),a("v-flex",{attrs:{sm4:"",xs8:"","py-0":""}},[a("v-text-field",{ref:"password",staticClass:"my-0 pt-0 dense",attrs:{dense:"",placeholder:"변경할 비밀번호",type:"password",rules:e.passwordRules,hint:"비워두면 현재 비밀번호가 유지됩니다."},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.submit(t))}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),a("v-layout",{attrs:{row:""}}),a("v-divider",{staticClass:"my-2"}),a("v-layout",[a("v-tooltip",{attrs:{bottom:""}},[a("v-switch",{staticClass:"pl-4",attrs:{slot:"activator",label:"프로필 공개"},slot:"activator",model:{value:e.profile.isOpenInfo,callback:function(t){e.$set(e.profile,"isOpenInfo",t)},expression:"profile.isOpenInfo"}}),a("span",[e._v("다른 회원들이 내 프로필(사진, 필명, 지역, 학년, 전공)을 볼 수 있습니다.")])],1)],1),a("v-layout",{attrs:{row:"","align-end":""}},[a("v-flex",{attrs:{xs4:""}},[a("v-tooltip",{attrs:{bottom:""}},[a("v-text-field",{staticClass:"mt-0 pt-0",attrs:{slot:"activator",label:"지역",disabled:"",hint:"NEIS이메일로 자동선택됩니다.",placeholder:"(미지정)","hide-details":""},slot:"activator",model:{value:e.profile.region,callback:function(t){e.$set(e.profile,"region",t)},expression:"profile.region"}}),a("span",[e._v("NEIS이메일로 자동선택됩니다.")])],1)],1),a("v-flex",{attrs:{xs4:""}},[a("v-tooltip",{attrs:{bottom:""}},[a("v-select",{staticClass:"dense mt-0 pt-0",attrs:{slot:"activator",items:e.majorItems,label:"전공",dense:"",disabled:!e.checkProfileUpdatable,"hide-details":""},slot:"activator",model:{value:e.major,callback:function(t){e.major=t},expression:"major"}}),a("span",[e._v(e._s(e.checkProfileUpdatable?"해당 전공 라운지에 글을 쓸 수 있습니다.":e.isMarch?"이미 올해에 변경하셨습니다.":"매년 3월에만 변경 가능합니다."))])],1)],1),a("v-flex",{attrs:{xs4:""}},[a("v-tooltip",{attrs:{bottom:""}},[a("v-select",{staticClass:"dense mt-0 pt-0",attrs:{slot:"activator",items:e.gradeItems,label:"학년",dense:"",disabled:!e.checkProfileUpdatable,"hide-details":""},slot:"activator",model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}}),a("span",[e._v(e._s(e.checkProfileUpdatable?"해당 학년 라운지에 글을 쓸 수 있습니다.":e.isMarch?"이미 올해에 변경하셨습니다.":"매년 3월에만 변경 가능합니다."))])],1)],1)],1)],1)],1)],1)])],1),a("v-card-actions",{attrs:{"pa-3":""}},[a("v-layout",{attrs:{row:e.$vuetify.breakpoint.smAndUp,column:e.$vuetify.breakpoint.xsOnly,"text-xs-right":""}},[a("v-btn",{staticClass:"mt-2",attrs:{flat:""},on:{click:e.reset}},[e._v("초기화")]),e.$vuetify.breakpoint.smAndUp?[a("v-flex",{staticClass:"mt-2"},[a("v-subheader",[a("v-btn",{staticClass:"short",attrs:{flat:""},on:{click:e.exit}},[a("small",[e._v("탈퇴")])])],1)],1),a("v-flex",[a("v-spacer")],1)]:e._e(),a("v-flex",{staticClass:"mt-2"},[a("v-btn",{attrs:{color:"primary",loading:e.loading,block:e.$vuetify.breakpoint.xsOnly},on:{click:e.submit}},[e._v("저장")])],1)],2)],1)],1)],1)],1)},o=[],r=i("713b"),s={name:"MyPage",data:function(){return{loading:!1,grade:null,major:null,password:null,gradeItems:[],majorItems:[],loungeNickNameErrors:[],topicNickNameErrors:[],passwordRules:[function(e){return!e||e.length>3&&e.length<26||"4~25자"}],nickNameRules:[function(e){return!!e&&""!==e||"닉네임/필명을 입력해주세요."},function(e){return!!e&&e.length>3&&e.length<=50||"4~50자로 입력해주세요."}],bottomSheet:!1,labels:{},userAuthItems:{N:"미인증(예비교사)",A:"인증",E:"인증만료(전직교사)",D:"인증제한"}}},computed:{isMarch:function(){return 2===(new Date).getMonth()},checkProfileUpdatable:function(){return!this.profile.infoModifiedDate||this.isMarch&&this.$moment(this.profile.infoModifiedDate,"YYYYMMDD").isBefore(this.$moment().date(1).month(2))},checkLoungeNickNameUpdatable:function(){return!this.profile.loungeNickNameModifiedDate||this.$moment(this.profile.loungeNickNameModifiedDate,"YYYYMMDD").add(1,"months").isBefore(this.$moment())},checkTopicNickNameUpdatable:function(){return!this.profile.topicNickNameModifiedDate||this.$moment(this.profile.topicNickNameModifiedDate,"YYYYMMDD").add(1,"months").isBefore(this.$moment())},webUrl:function(){return"https://pedagy.com"},profile:function(){return Object.assign({},this.$store.getters.profile)}},created:function(){var e=this;this.$emit("update:layout",r["a"]),this.$store.dispatch("setColumnType","HIDE_ALWAYS"),this.reset(),this.$axios.get("/group",{params:{groupType:["M","G"]},headers:{silent:!0}}).then(function(t){e.checkProfileUpdatable?(e.majorItems=t.data.filter(function(e){return"M"===e.groupType}).map(function(e){return{text:e.groupName,value:e.groupId}}),e.majorItems.splice(0,0,{text:"(미지정)",value:null}),e.gradeItems=t.data.filter(function(e){return"G"===e.groupType}).map(function(e){return{text:e.groupName,value:e.groupId}}),e.gradeItems.splice(0,0,{text:"(미지정)",value:null})):(e.majorItems=t.data.filter(function(t){return"M"===t.groupType&&t.groupId===e.profile.major}).map(function(e){return{text:e.groupName,value:e.groupId}}),e.majorItems.splice(0,0,{text:"(미지정)",value:null}),e.gradeItems=t.data.filter(function(t){return"G"===t.groupType&&t.groupId===e.profile.grade}).map(function(e){return{text:e.groupName,value:e.groupId}}),e.gradeItems.splice(0,0,{text:"(미지정)",value:null}))}).catch(function(t){console.log(t),e.$store.dispatch("showSnackbar",{text:"전공, 학년 목록을 가져오지 못했습니다.".concat(t&&t.response&&t.response.data?"["+t.response.data.message+"]":""),color:"error"})})},methods:{reset:function(){void 0===this.profile.major?this.major=null:this.major=this.profile.major,void 0===this.profile.grade?this.grade=null:this.grade=this.profile.grade,this.password=null},checkNickName:function(e,t){var i,a,o=this;switch(e){case"loungeNickName":this.loungeNickNameErrors=[],this.$refs.loungeNickName.validate(),a=this.profile.loungeNickName,i=this.loungeNickNameErrors;break;case"topicNickName":this.topicNickNameErrors=[],this.$refs.topicNickName.validate(),a=this.profile.topicNickName,i=this.topicNickNameErrors;break;default:return void("function"===typeof t&&t.call(this))}0===i.length&&a!==this.$store.getters.profile[e]?this.$axios.get("/nickName",{params:{nickName:a},headers:{silent:!0}}).then(function(){"function"===typeof t&&t.call(o)}).catch(function(e){i.push(e.response&&e.response.data.message||"사용할 수 없는 닉네임/필명입니다."),"function"===typeof t&&t.call(o)}):"function"===typeof t&&t.call(this)},focus:function(e){this.$refs[e]&&this.$refs[e].focus()},submit:function(){var e=this;this.$refs.form.validate()?this.checkNickName("topicNickName",function(){e.checkNickName("loungeNickName",function(){if(0===e.loungeNickNameErrors.length&&0===e.topicNickNameErrors.length){var t={},i=e.$store.getters.profile;if(e.profile.topicNickName!==i.topicNickName&&(e.checkNickName("topicNickName"),t.topicNickName=e.profile.topicNickName),e.profile.loungeNickName!==i.loungeNickName&&(e.checkNickName("loungeNickName"),t.loungeNickName=e.profile.loungeNickName),e.profile.isOpenInfo!==i.isOpenInfo&&(t.isOpenInfo=e.profile.isOpenInfo),e.major===i.major||null===e.major&&void 0===i.major||!e.checkProfileUpdatable||(t.major=e.major),e.grade===i.grade||null===e.grade&&void 0===i.grade||!e.checkProfileUpdatable||(t.grade=e.grade),e.password&&""!==e.password&&(t.password=e.password),Object.keys(t).length>0){if((void 0!==t.major||void 0!==t.grade)&&!confirm("전공을 ".concat(t.major&&e.majorItems.find(function(e){return e.value===t.major})?e.majorItems.find(function(e){return e.value===t.major}).text+"로 지정":"지정해제",", 학년을 ").concat(t.grade&&e.gradeItems.find(function(e){return e.value===t.grade})?e.gradeItems.find(function(e){return e.value===t.grade}).text+"로 지정":"지정해제","하시겠습니까?\n한 번 변경하면 올해에는 추가로 변경이 불가능하니, 신중히 선택해주세요.")))return;e.loading=!0,e.$axios.put("/user",t).then(function(i){e.password=null,e.loading=!1,e.$store.dispatch("showSnackbar",{text:"내 정보를 변경하였습니다.",color:"success"}),void 0===t.major&&void 0===t.grade||(t.infoModifiedDate=e.$moment().format("YMMDD"),e.profile.infoModifiedDate=t.infoModifiedDate),t.topicNickName&&(t.topicNickNameModifiedDate=e.$moment().format("YMMDD"),e.profile.topicNickNameModifiedDate=t.topicNickNameModifiedDate),t.loungeNickName&&(t.loungeNickNameModifiedDate=e.$moment().format("YMMDD"),e.profile.loungeNickNameModifiedDate=t.loungeNickNameModifiedDate),e.$store.dispatch("updateProfile",t)}).catch(function(t){e.loading=!1,e.$store.dispatch("showSnackbar",{text:"정보를 변경하지 못했습니다.".concat(t.response?"["+t.response.data.message+"]":""),color:"error"}),console.log(t)})}else e.$store.dispatch("showSnackbar",{text:"변경된 내용이 없습니다."})}})}):this.$store.dispatch("showSnackbar",{text:"변경할 정보를 확인해주세요.",color:"error"})},deleteProfilePath:function(){var e=this;this.$axios.put("/user",{picturePath:""}).then(function(t){e.$store.dispatch("updateProfile",{picturePath:null}),e.profile.picturePath=null}).catch(function(t){console.log(t),e.$store.dispatch("showSnackbar",{text:"".concat(t.response?t.response.data.message:"프로필 이미지를 삭제하지 못했습니다."),color:"error"})}),this.bottomSheet=!1},exit:function(){var e=this;confirm("정말 탈퇴하시겠습니까?\n등록한 이메일로의 재가입은 불가능합니다.")&&this.$axios.put("/user",{status:"DELETED"}).then(function(t){e.$store.dispatch("showSnackbar",{text:"정상적으로 탈퇴처리되었습니다. 이용해주셔서 감사합니다."}),e.$store.dispatch("signout"),e.$router.push("/index")}).catch(function(t){console.log(t),e.$store.dispatch("showSnackbar",{text:"".concat(t.response?t.response.data.message:"탈퇴하지 못했습니다. 관리자에게 문의해주세요."),color:"error"})})},selectImage:function(){var e=this,t=document.getElementById("profileFile");t||(t=document.createElement("input"),t.setAttribute("id","profileFile"),t.setAttribute("type","file"),t.setAttribute("accept","image/*"),t.classList.add("d-none"),document.body.appendChild(t)),t.onchange=function(){if(t.files[0]&&t.files[0].type.startsWith("image/"))if(t.files[0].size>409600)e.$store.dispatch("showSnackbar",{text:"최대 400KB 이하의 이미지만 업로드할 수 있습니다.",color:"error"});else{var i=new FormData;i.append("picture",t.files[0],t.files[0].name),e.$axios.post("/user/picture",i).then(function(t){e.profile.picturePath=t.data.picturePath,e.$store.dispatch("updateProfile",{picturePath:e.profile.picturePath})}).catch(function(t){e.$store.dispatch("showSnackbar",{text:"".concat(t.response?t.response.data.message:"프로필 이미지를 업로드하지 못했습니다."),color:"error"})})}else e.$store.dispatch("showSnackbar",{text:"이미지 파일만 업로드할 수 있습니다.",color:"error"})},t.click()}},watch:{"profile.loungeNickName":function(){this.loungeNickNameErrors.length>0&&(this.loungeNickNameErrors=[])},"profile.topicNickName":function(){this.topicNickNameErrors.length>0&&(this.topicNickNameErrors=[])}}},n=s,c=i("0c7c"),l=Object(c["a"])(n,a,o,!1,null,null,null);t["default"]=l.exports}}]);