(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08bfca49"],{"158c":function(t,e,r){"use strict";var o=r("f94a"),s=r.n(o);s.a},5347:function(t,e,r){"use strict";var o=r("c1df"),s=r.n(o);const a={data(){return{boardTypeItems:{T:"토픽",L:"라운지",D:"아카이브",X:"게시판",E:"전직교사",N:"예비교사"},webUrl:"https://pedagy.com"}},methods:{uuid(){let t=()=>{return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},dataURItoBlob(t){var e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var r=t.split(",")[0].split(":")[1].split(";")[0],o=new Uint8Array(e.length),s=0;s<e.length;s++)o[s]=e.charCodeAt(s);return new Blob([o],{type:r})},timeParser(t){return s()(t,"YYYYMMDDHHmmss").fromNow()}}};e["a"]=a},"5d6d":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.board?r("v-container",{attrs:{fluid:"","pt-2":""}},[r("v-card",{staticClass:"mb-2",attrs:{flat:""}},[r("v-card-title",{staticClass:"py-2",attrs:{"primary-title":""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",[r("v-layout",{attrs:{row:"","align-center":""}},[r("v-flex",[r("v-layout",{attrs:{row:"","align-center":""}},[r("span",{staticClass:"title cursor-pointer",on:{click:function(e){t.$route.params.documentId||t.$route.path.endsWith("write")?t.$router.push("/"+t.board.boardId):t.openDialog()}}},[t._v(t._s(t.board.boardName))]),t.reservedContents?r("v-tooltip",{staticClass:"cursor-default",attrs:{bottom:"","close-delay":"500"}},[r("v-icon",{staticClass:"ml-1 vertical-align-middle",attrs:{slot:"activator",color:"primary"},slot:"activator"},[t._v("event_note")]),r("span",{domProps:{innerHTML:t._s(t.reservedContents)}})],1):t._e(),t.childBoardItems.length>1?r("span",{staticClass:"ml-2"},[r("v-select",{staticClass:"hideLine dense childBoardSelector mt-0 pt-0",attrs:{id:"childBoardSelector",flat:"",dense:"",items:t.childBoardItems,"item-text":"boardName","item-value":"boardId","single-line":"","hide-details":""},on:{input:t.childBoardChanged},model:{value:t.childBoardId,callback:function(e){t.childBoardId=e},expression:"childBoardId"}})],1):"T"!==t.board.boardType||"topicBest"===t.board.boardId||t.$store.getters.userBoards.some(function(e){return e.boardId===t.board.boardId})?t._e():r("v-btn",{staticClass:"short my-0",attrs:{small:"",depressed:"",color:"accent"},on:{click:t.openDialog}},[t._v("구독")])],1)],1),r("v-spacer"),r("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.$route.path.endsWith("write")&&!t.$route.path.endsWith("edit")&&("loungeBest"!==t.$route.params.boardId&&"topicBest"!==t.$route.params.boardId||t.documentBoardId&&t.$route.params.documentId),expression:"!$route.path.endsWith('write') && !$route.path.endsWith('edit') && (($route.params.boardId !== 'loungeBest' && $route.params.boardId !== 'topicBest') || (documentBoardId && $route.params.documentId))"}],staticClass:"ma-0",attrs:{depressed:"",color:"primary",icon:"",small:t.$vuetify.breakpoint.xsOnly},on:{click:t.moveToWriteDocument}},[r("v-icon",{attrs:{small:""}},[t._v("edit")])],1)],1)],1),r("v-flex",{directives:[{name:"show",rawName:"v-show",value:t.board.boardDescription,expression:"board.boardDescription"}]},[r("span",{staticClass:"caption"},[t._v("\n            "+t._s(t.board.boardDescription)+"\n            "),r("v-icon",{staticClass:"vertical-align-middle",attrs:{small:""},on:{click:t.openDialog}},[t._v("info")])],1)])],1)],1)],1),r("v-card",{class:{"my-3":t.$route.path.endsWith("write")||t.$route.path.endsWith("edit")},attrs:{flat:""}},[r("router-view",{attrs:{board:t.board,documentBoardId:t.documentBoardId},on:{"update:documentBoardId":function(e){t.documentBoardId=e},"update:document-board-id":function(e){t.documentBoardId=e}}})],1),r("v-card",{directives:[{name:"show",rawName:"v-show",value:!t.$route.path.endsWith("write")&&!t.$route.path.endsWith("edit"),expression:"!$route.path.endsWith('write') && !$route.path.endsWith('edit')"}],attrs:{flat:""}},[r("document-list",{attrs:{board:t.board,hasChildren:!t.board.parentBoardId&&t.childBoardItems.length>1,documentBoardId:t.documentBoardId},on:{write:t.moveToWriteDocument,"update:documentBoardId":function(e){t.documentBoardId=e},"update:document-board-id":function(e){t.documentBoardId=e}}})],1),r("v-dialog",{attrs:{"max-width":"800",lazy:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("board-information",{attrs:{board:t.selected},on:{closeDialog:t.closeDialog}})],1)],1):t._e()},s=[],a=r("713b"),d=r("41cb"),i=r("5347");const n={M:"전공",G:"학년",N:"일반",R:"지역",Z:"인증"};var h={name:"Board",data:()=>({board:void 0,writeButton:!0,childBoardId:null,dialog:!1,selected:null,userAuthItems:{N:"예비교사",A:"인증",E:"전직교사",D:"인증제한"},groupItems:[],allGroupAuthItems:{READWRITE:"전체구독허용",READONLY:"읽기공개",NONE:"비공개"},documentBoardId:null}),props:["boardId"],mixins:[i["a"]],components:{DocumentList:()=>r.e("chunk-11693ce8").then(r.bind(null,"3497")),BoardInformation:()=>r.e("chunk-2d21ddd6").then(r.bind(null,"d2b4"))},computed:{childBoardItems(){if(this.board.parentBoardId){let t=this.$store.getters.boards.filter(t=>t.parentBoardId===this.board.parentBoardId&&t.boardId!==this.boardId);return t.splice(0,0,this.$store.getters.boards.find(t=>t.boardId===this.board.parentBoardId)),t.splice(0,0,{boardId:null,boardName:this.childBoardLabel}),t}{let t=this.$store.getters.boards.filter(t=>t.parentBoardId===this.boardId);return t.splice(0,0,{boardId:null,boardName:this.childBoardLabel}),t}},childBoardLabel(){return(this.board.parentBoardId?"관련 ":"하위 ")+this.boardTypeItems[this.board.boardType]},reservedContents(){if(this.board&&this.board.reservedContents){let t=this.board.reservedContents,e=this.$moment(this.board.reservedDate,"YYYYMMDD").format("Y.M.D 이후 아래와 같이 변경될 예정입니다.<br>");for(let r in t)switch(r){case"boardName":e+=`${this.boardTypeItems[this.board.boardType]} 이름 : ${t[r]}<br>`;break;case"boardDescription":e+=`${this.boardTypeItems[this.board.boardType]} 설명 : ${t[r]}<br>`;break;case"allowAnonymous":e+=`익명글 : ${t[r]?"허용":"비허용"}<br>`;break;case"useCategory":e+=`카테고리 : ${t[r]?"사용":"미사용"}<br>`;break;case"allGroupAuth":e+=`${this.boardTypeItems[this.board.boardType]} 공개/비공개 : ${this.allGroupAuthItems[t[r]]}<br>`;break;case"ownerNickName":e+=`${this.boardTypeItems[this.board.boardType]}지기 : ${t[r]}<br>`;break;case"auth":e+=`구독(글쓰기) 권한 : ${t[r].filter(t=>this.groupItems.some(e=>e.value===t.groupId)).map(t=>this.groupItems.find(e=>e.value===t.groupId).text+("INSERT"===t.command?" 추가":"DELETE"===t.command?" 삭제":"")).join(", ")}<br>`;break;case"status":e+="DELETED"===t[r]?`<b>${this.boardTypeItems[this.board.boardType]} 삭제 예정</b><br>`:"";break}return e}return null}},methods:{moveToWriteDocument(){let t=this.board,e=this.childBoardItems;if("loungeBest"!==t.boardId&&"topicBest"!==t.boardId||!this.documentBoardId||(t=this.$store.getters.boards.find(t=>t.boardId===this.documentBoardId),t||(t=this.board),t.parentBoardId?(e=this.$store.getters.boards.filter(t=>t.parentBoardId===this.board.parentBoardId&&t.boardId!==this.boardId),e.splice(0,0,this.$store.getters.boards.find(t=>t.boardId===this.board.parentBoardId)),e.splice(0,0,{boardId:null,boardName:this.childBoardLabel})):(e=this.$store.getters.boards.filter(t=>t.parentBoardId===this.boardId),e.splice(0,0,{boardId:null,boardName:this.childBoardLabel}))),!t.parentBoardId&&e.length>1){const e=this.$store.getters.profile,r=this.$store.getters.userBoards.find(e=>e.boardId===t.boardId);let o=this.$store.getters.boards.filter(o=>o.parentBoardId===t.boardId&&o.statusAuth.write.includes(e.auth)&&("T"===t.boardType?r&&(!r.writeRestrictDate||this.$moment(r.writeRestrictDate,"YYYYMMDD").isBefore(this.$moment())):o.allowedGroups.some(t=>t===e.region||t===e.major||t===e.grade||e.groups.includes(t))&&(!r||!r.writeRestrictDate||this.$moment(r.writeRestrictDate,"YYYYMMDD").isBefore(this.$moment()))));o.length>0?(this.$router.push(`/${o[0].boardId}/write`),this.$store.dispatch("showSnackbar",{text:`글을 쓸 수 있는 ${o[0].boardName}에 작성됩니다.`,color:"info"})):"T"===this.board.boardType?this.$store.dispatch("showSnackbar",{text:"글을 쓸 토픽을 선택하여 구독해주세요",color:"info"}):(o=this.$store.getters.boards.filter(r=>r.parentBoardId===t.boardId&&r.statusAuth.write.includes(e.auth)),0===o.length?this.$store.dispatch("showSnackbar",{text:"인증 후에 글을 쓸 수 있습니다.",color:"info"}):(o=o.filter(t=>t.allowedGroups.some(t=>t===e.region||t===e.major||t===e.grade||e.groups.includes(t))),0===o.length?this.$store.dispatch("showSnackbar",{text:`현재 소속된 ${this.boardTypeItems[t.boardType]}가 없습니다. ${this.$vuetify.breakpoint.xsOnly?"학년, 전공을 지정해주세요.":"내 계정정보에서 학년, 전공을 지정해주세요."}`,color:"info"}):this.$store.dispatch("showSnackbar",{text:`현재 ${o[0].boardName}에 글쓰기가 제한되어있습니다.`,color:"info"})))}else{const e=this.$store.getters.profile;if(t.statusAuth.write.includes(e.auth))if("T"===t.boardType)if(this.$store.getters.userBoards.some(e=>e.boardId===t.boardId)){const e=this.$store.getters.userBoards.find(e=>e.boardId===t.boardId);!e.writeRestrictDate||this.$moment(e.writeRestrictDate,"YYYYMMDD").isBefore(this.$moment())?this.$router.push(`/${t.boardId}/write`):this.$store.dispatch("showSnackbar",{text:`글쓰기가 ${this.$moment(e.writeRestrictDate,"YYYYMMDD").format("Y/M/D")}까지 제한되었습니다.`})}else"READWRITE"===t.allGroupAuth||t.allowedGroups.some(t=>t===e.region||t===e.major||t===e.grade||e.groups.includes(t))?this.$axios.post("/user/board",{boardId:t.boardId}).then(e=>{this.$store.dispatch("addUserBoard",Object.assign({},t)),this.$store.dispatch("showSnackbar",{text:`${t.boardName} 토픽을 구독하였습니다.`,color:"info"}),this.$router.push(`/${t.boardId}/write`)}).catch(t=>{console.log(t),this.$store.dispatch("showSnackbar",{text:`글을 쓰기 위한 구독을 하지 못했습니다.${t&&t.response&&t.response.data?"["+t.response.data.message+"]":""}`,color:"error"})}):this.$store.dispatch("showSnackbar",{text:"내가 구독할 수 없는 토픽입니다.",color:"info"});else if("READWRITE"===t.allGroupAuth||t.allowedGroups.some(t=>t===e.region||t===e.major||t===e.grade||e.groups.includes(t)))if(this.$store.getters.userBoards.some(e=>e.boardId===t.boardId)){const e=this.$store.getters.userBoards.find(e=>e.boardId===t.boardId);!e.writeRestrictDate||this.$moment(e.writeRestrictDate,"YYYYMMDD").isBefore(this.$moment())?this.$router.push(`/${t.boardId}/write`):this.$store.dispatch("showSnackbar",{text:`글쓰기가 ${this.$moment(e.writeRestrictDate,"YYYYMMDD").format("Y/M/D")}까지 제한되었습니다.`})}else this.$router.push(`/${t.boardId}/write`);else this.$store.dispatch("showSnackbar",{text:`현재 소속된 ${this.boardTypeItems[t.boardType]}가 아닙니다.`,color:"info"});else this.$store.dispatch("showSnackbar",{text:`${t.statusAuth.write.map(t=>this.userAuthItems[t]).join(", ")}회원만 글을 쓸 수 있습니다.`,color:"info"})}},async getBoard(t){let e;try{e=await this.$axios.get(`/board?boardId=${t}`)}catch(r){return console.log(r),this.$store.dispatch("showSnackbar",{text:`${r&&r.response&&r.response.data&&r.response.data.message||"게시판 정보를 가져오지 못했습니다."}`,color:"error"}),!1}return this.setBoard(e.data),!0},writeDocument(){this.$router.push(`/${this.boardId}/write`)},setBoard(t){this.board=t,document.title=t.boardName?t.boardName+" - Pedagy":"Pedagy",this.$store.dispatch("switchBoardType","T"===this.board.boardType?"T":"L")},childBoardChanged(){this.childBoardId&&this.$router.push("/"+this.childBoardId)},subscribe(){this.$axios.post("/user/board",{boardId:this.board.boardId}).then(t=>{this.$store.dispatch("addUserBoard",Object.assign({},this.board)),this.$store.dispatch("showSnackbar",{text:`${this.board.boardName} 토픽을 구독하였습니다! 구독 기념 글을 작성해보세요.`,color:"success"})}).catch(t=>{console.log(t),this.$store.dispatch("showSnackbar",{text:`${t&&t.response&&t.response.data&&t.response.data.message||`${this.board.boardName} 구독을 하지 못했습니다.`}`,color:"error"})})},openDialog(){this.selected&&this.selected.boardId===this.board.boardId?this.dialog=!0:this.$axios.get("/board",{params:{boardId:this.board.boardId}}).then(t=>{this.selected=t.data,this.dialog=!0}).catch(t=>{console.log(t),this.$store.dispatch("showSnackbar",{text:`정보를 가져오지 못했습니다.${t&&t.response&&t.response.data?"["+t.response.data.message+"]":""}`,color:"error"})})},closeDialog(){this.dialog=!1}},created(){this.$emit("update:layout",a["a"]),this.$store.dispatch("setColumnType","HIDE_SM"),this.$store.getters.groups?this.groupItems=this.$store.getters.groups:this.$axios.get("/group",{headers:{silent:!0}}).then(t=>{t.data.forEach(t=>{"N"!==t.groupType&&"D"!==t.groupType&&"E"!==t.groupType||(t.groupType="Z")}),this.groupItems=t.data.sort((t,e)=>t.groupType<e.groupType?-1:t.groupType===e.groupType?0:1);let e=null,r=0;while(r<this.groupItems.length)e!==this.groupItems[r].groupType&&(e?(e=this.groupItems[r].groupType,this.groupItems.splice(r,0,{divider:!0}),r++):e=this.groupItems[r].groupType,this.groupItems.splice(r,0,{header:n[e]}),r++),r++;this.groupItems=this.groupItems.map(t=>t.groupName?{text:t.groupName,value:t.groupId}:t),this.$store.dispatch("setGroups",this.groupItems)}).catch(t=>{this.$store.dispatch("showSnackbar",{text:`그룹 목록을 가져오지 못했습니다.${t&&t.response&&t.response.data?"["+t.response.data.message+"]":""}`})})},async beforeRouteUpdate(t,e,r){this.$store.getters.boards.some(e=>e.boardId===t.params.boardId)?(this.setBoard(this.$store.getters.boards.find(e=>e.boardId===t.params.boardId)),this.$store.dispatch("setColumnType","HIDE_SM"),this.$nextTick(()=>this.childBoardId=null),r()):await this.getBoard(t.params.boardId)?(this.$store.dispatch("setColumnType","HIDE_SM"),this.$nextTick(()=>this.childBoardId=null),r()):r("/error?error=404")},async beforeRouteEnter(t,e,r){if(d["a"].app.$store.getters.boards.some(e=>e.boardId===t.params.boardId))r(e=>{e.setBoard(d["a"].app.$store.getters.boards.find(e=>e.boardId===t.params.boardId))});else{let e;try{e=await d["a"].app.$axios.get("/board",{params:{boardId:t.params.boardId}})}catch(o){return void r("/error?error="+(o.response&&o.response.status||"404"))}r(t=>{t.setBoard(e.data)})}}},c=h,l=(r("158c"),r("0c7c")),p=Object(l["a"])(c,o,s,!1,null,null,null);e["default"]=p.exports},f94a:function(t,e,r){}}]);
//# sourceMappingURL=chunk-08bfca49.f1245b1c.js.map